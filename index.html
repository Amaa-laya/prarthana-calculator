<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NSB Savings Calculator</title>
<style>
  :root {
    --nsb: #f58220;
    --grey: #e0e0e0;
  }
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #f5f5f5;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding-top: 50px;
  }
  .container {
    background: #fff;
    padding: 28px 26px;
    border-radius: 16px;
    box-shadow: 0 4px 18px rgba(0,0,0,.1);
    max-width: 960px;
    width: 100%;
    box-sizing: border-box;
  }
  h2 {
    margin: 0 0 22px;
    text-align: center;
    color: var(--nsb);
  }
  /* Sidebar */
  .hamburger {
    position: fixed;
    top: 18px;
    left: 18px;
    background: #fff;
    color: var(--nsb);
    font-size: 28px;
    padding: 6px 12px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,.15);
    cursor: pointer;
    z-index: 1100;
    user-select: none;
  }
  .sidebar {
    position: fixed;
    left: -260px;
    top: 0;
    width: 260px;
    height: 100%;
    background: var(--nsb);
    padding-top: 60px;
    transition: left 0.3s ease;
    z-index: 1000;
    box-sizing: border-box;
  }
  .sidebar.open {
    left: 0;
  }
  .sidebar a {
    display: block;
    padding: 16px 24px;
    color: #fff;
    text-decoration: none;
    font-weight: bold;
    font-size: 18px;
  }
  .sidebar a:hover {
    background: #e06d0f;
  }
  /* Language selector */
  .lang {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 10px;
  }
  .lang select {
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 15px;
  }
  /* Tabs */
  .tabs {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 18px;
  }
  .tab {
    background: var(--grey);
    padding: 10px 24px;
    margin: 4px;
    border-radius: 8px;
    cursor: pointer;
    white-space: nowrap;
    user-select: none;
    transition: 0.3s;
  }
  .tab.active {
    background: var(--nsb);
    color: #fff;
  }
  /* Tab content */
  .tab-content {
    display: none;
  }
  .tab-content.active {
    display: block;
  }
  /* Form */
  form {
    border: 2px solid var(--nsb);
    padding: 20px;
    border-radius: 12px;
  }
  .form-grid {
    display: grid;
    grid-template-columns: minmax(120px, 1fr) 2fr;
    gap: 12px 20px;
    align-items: center;
  }
  .form-grid-full {
    grid-column: 1/-1;
  }
  @media(max-width: 540px) {
    .form-grid {
      grid-template-columns: 1fr;
    }
  }
  label {
    font-weight: 600;
  }
  input, select {
    width: 100%;
    padding: 10px;
    border: 2px solid var(--nsb);
    border-radius: 8px;
    font-size: 15px;
    box-sizing: border-box;
    max-width: 100%;
  }
  .btns {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 10px;
  }
  button {
    background: var(--nsb);
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 9px 14px;
    font-size: 15px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    user-select: none;
    white-space: nowrap;
  }
  button:hover {
    background: #e06d0f;
  }
  .result {
    margin-top: 18px;
    min-height: 80px;
    font-size: 17px;
    font-weight: bold;
    color: #1976d2;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<!-- Sidebar hamburger -->
<span class="hamburger" onclick="toggleSidebar()">‚ò∞</span>

<!-- Sidebar menu -->
<nav id="sidebar" class="sidebar">
  <a href="#" onclick="setProduct('prarthana');closeSidebar()">Prarthana</a>
  <a href="#" onclick="setProduct('reality');closeSidebar()">Reality</a>
</nav>

<!-- Main container -->
<div class="container">
  <!-- Language selector -->
  <div class="lang">
    <select id="lang" onchange="applyLang()">
      <option value="en">English</option>
      <option value="si">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</option>
      <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    </select>
  </div>

  <!-- Title -->
  <h2 id="title">NSB Prarthana Savings Calculator</h2>

  <!-- Tabs -->
  <div class="tabs">
    <div id="tabReqBtn" class="tab active" onclick="showTab('req')">ü™ô <span id="txtReq">Required Deposit</span></div>
    <div id="tabMatBtn" class="tab" onclick="showTab('mat')">üí∞ <span id="txtMat">Maturity Value</span></div>
  </div>

  <!-- Required Deposit Tab -->
  <div id="req" class="tab-content active">
    <form id="formReq" onsubmit="event.preventDefault(); calcReq()">
      <div class="form-grid">
        <label id="lblOpen" for="open">Opening Date:</label>
        <input id="open" type="date" required onchange="updateMaturityDate()">
        
        <label id="lblPer" for="per">Period:</label>
        <select id="per" required onchange="updateMaturityDate()"></select>
        
        <label id="lblMdate" for="mdate">Maturity Date:</label>
        <input id="mdate" type="date" disabled>
        
        <label id="lblTarget" for="target">Target Amount (LKR):</label>
        <input id="target" type="number" min="0" step="0.01" required>
        
        <label id="lblRate" for="rate">Interest Rate (%/yr):</label>
        <input id="rate" type="number" min="0" step="0.01" required>
      </div>
      <div class="btns form-grid-full">
        <button type="submit">üßÆ <span id="bCalc1">Calculate</span></button>
        <button type="button" onclick="resetAll()">üßπ <span id="bClr1">Clear</span></button>
        <button type="button" onclick="printRes('res1')">üñ®Ô∏è <span id="bPrt1">Print</span></button>
        <button type="button" onclick="mailRes('res1')">üìß <span id="bMail1">Email</span></button>
      </div>
    </form>
    <div id="res1" class="result"></div>
  </div>

  <!-- Maturity Value Tab -->
  <div id="mat" class="tab-content">
    <form id="formMat" onsubmit="event.preventDefault(); calcMat()">
      <div class="form-grid">
        <label id="lblOpen2" for="open2">Opening Date:</label>
        <input id="open2" type="date" required onchange="updateMaturityDateMat()">
        
        <label id="lblPer2" for="per2">Period:</label>
        <select id="per2" required onchange="updateMaturityDateMat()"></select>
        
        <label id="lblMdate2" for="mdate2">Maturity Date:</label>
        <input id="mdate2" type="date" disabled>
        
        <label id="lblAmt" for="amt">Monthly Installment (LKR):</label>
        <input id="amt" type="number" min="0" step="0.01" required>
        
        <label id="lblRate2" for="rate2">Interest Rate (%/mo):</label>
        <input id="rate2" type="number" min="0" step="0.01" required>
      </div>
      <div class="btns form-grid-full">
        <button type="submit">üßÆ <span id="bCalc2">Calculate</span></button>
        <button type="button" onclick="resetAll()">üßπ <span id="bClr2">Clear</span></button>
        <button type="button" onclick="printRes('res2')">üñ®Ô∏è <span id="bPrt2">Print</span></button>
        <button type="button" onclick="mailRes('res2')">üìß <span id="bMail2">Email</span></button>
      </div>
    </form>
    <div id="res2" class="result"></div>
  </div>
</div>

<script>
// Utility function shortcut
const $ = id => document.getElementById(id);

// Product and language globals
let prod = 'prarthana'; // 'prarthana' or 'reality'

// Period options
const Y = [3, 5, 10, 15, 20];  // years for Prarthana
const M = [12, 24, 36, 48, 60]; // months for Reality

// Language dictionary (all labels & buttons)
const TXT = {
  en: {
    titlePr: 'NSB Prarthana Savings Calculator',
    titleRe: 'NSB Reality Savings Calculator',
    req: 'Required Deposit',
    mat: 'Maturity Value',
    target: 'Target Amount (LKR):',
    deposit: 'Deposit Amount (LKR):',
    install: 'Monthly Installment (LKR):',
    calc: 'Calculate',
    clear: 'Clear',
    print: 'Print',
    email: 'Email',
    open: 'Opening Date:',
    per: 'Period:',
    matDate: 'Maturity Date:',
    rateYr: 'Interest Rate (%/yr):',
    rateMo: 'Interest Rate (%/mo):'
  },
  si: {
    titlePr: 'NSB ‡∂¥‡∑ä‚Äç‡∂ª‡∑è‡∂ª‡∑ä‡∂Æ‡∂±‡∑è ‡∂â‡∂≠‡∑í‡∂ª‡∑í‡∂ö‡∂ª‡∂´ ‡∂ú‡∂´‡∂ö‡∂∫',
    titleRe: 'NSB ‡∂ª‡∑í‡∂∫‡∑ê‡∂Ω‡∑í‡∂ß‡∑í ‡∂â‡∂≠‡∑í‡∂ª‡∑í‡∂ö‡∂ª‡∂´ ‡∂ú‡∂´‡∂ö‡∂∫',
    req: '‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î',
    mat: '‡∂¥‡∑í‡∂ª‡∑í‡∂±‡∑ê‡∂∏‡∑ì‡∂∏‡∑ä ‡∑Ä‡∂ß‡∑í‡∂±‡∑è‡∂ö‡∂∏',
    target: '‡∂Ö‡∂ª‡∂∏‡∑î‡∂´‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω (‡∂ª‡∑î.):',
    deposit: '‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω (‡∂ª‡∑î.):',
    install: '‡∂∏‡∑è‡∑É‡∑í‡∂ö ‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î (‡∂ª‡∑î.):',
    calc: '‡∂ú‡∂´‡∂±‡∂∫',
    clear: '‡∂ö‡∑Ö‡∂Ω',
    print: '‡∂∏‡∑î‡∂Ø‡∑ä‚Äç‡∂ª‡∂´‡∂∫',
    email: '‡∂ä-‡∂≠‡∑ê‡∂¥‡∑ë‡∂Ω',
    open: '‡∑Ä‡∑í‡∑Ä‡∑ò‡∂≠ ‡∂ö‡∂ª‡∂± ‡∂Ø‡∑í‡∂±‡∂∫:',
    per: '‡∂ö‡∑è‡∂Ω‡∂∫:',
    matDate: '‡∂¥‡∑í‡∂ª‡∑í‡∂±‡∑ê‡∂∏‡∑ì‡∂∏‡∑ä ‡∂Ø‡∑í‡∂±‡∂∫:',
    rateYr: '‡∂¥‡∑ú‡∂Ω‡∑ì ‡∂Ö‡∂±‡∑î‡∂¥‡∑è‡∂≠‡∂∫ (% ‡∑Ä‡∑É‡∂ª):',
    rateMo: '‡∂¥‡∑ú‡∂Ω‡∑ì ‡∂Ö‡∂±‡∑î‡∂¥‡∑è‡∂≠‡∂∫ (% ‡∂∏‡∑è‡∑É‡∑í‡∂ö):'
  },
  ta: {
    titlePr: 'NSB ‡Æ™‡Æ∞‡Ææ‡Æ§‡Øç‡Æ§‡Æ©‡Ææ ‡Æö‡Øá‡ÆÆ‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æï‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Øç',
    titleRe: 'NSB ‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ≤‡Æø‡Æü‡Øç‡Æü‡Æø ‡Æö‡Øá‡ÆÆ‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æï‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡Ææ‡Æ©‡Øç',
    req: '‡Æ§‡Øá‡Æµ‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ',
    mat: '‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
    target: '‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Øä‡Æï‡Øà (‡Æ∞‡ØÇ.)',
    deposit: '‡Æµ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ§‡Øä‡Æï‡Øà (‡Æ∞‡ØÇ.)',
    install: '‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡Æµ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ (‡Æ∞‡ØÇ.)',
    calc: '‡Æï‡Æ£‡Æï‡Øç‡Æï‡Æø‡Æü‡ØÅ',
    clear: '‡ÆÖ‡Æ¥‡Æø',
    print: '‡ÆÖ‡Æö‡Øç‡Æö‡ØÅ',
    email: '‡ÆÆ‡Æø‡Æ©‡Øç‡Æ©‡Æû‡Øç‡Æö‡Æ≤‡Øç',
    open: '‡Æ§‡Æø‡Æ±‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Øá‡Æ§‡Æø:',
    per: '‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç:',
    matDate: '‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ ‡Æ§‡Øá‡Æ§‡Æø:',
    rateYr: '‡Æµ‡Æü‡Øç‡Æü‡Æø ‡Æµ‡Æø‡Æï‡Æø‡Æ§‡ÆÆ‡Øç (%/‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ):',
    rateMo: '‡Æµ‡Æü‡Øç‡Æü‡Æø ‡Æµ‡Æø‡Æï‡Æø‡Æ§‡ÆÆ‡Øç (%/‡ÆÆ‡Ææ‡Æ§‡ÆÆ‡Øç):'
  }
};

// Helper: get current language from dropdown
function curLang() {
  return $('lang').value || 'en';
}

// Show/hide sidebar
function toggleSidebar() {
  $('sidebar').classList.toggle('open');
}
function closeSidebar() {
  $('sidebar').classList.remove('open');
}

// Switch product and update UI accordingly
function setProduct(p) {
  prod = p;
  applyLang();
  populatePeriods();
  resetAll();
  showTab('req'); // default tab when switching product
  closeSidebar();
}

// Populate period selects based on product
function populatePeriods() {
  const perSel = $('per');
  const perSel2 = $('per2');
  perSel.innerHTML = '';
  perSel2.innerHTML = '';
  let options, labelSuffix;
  if (prod === 'prarthana') {
    options = Y;
    labelSuffix = ' years';
  } else {
    options = M;
    labelSuffix = ' months';
  }
  options.forEach(v => {
    let opt1 = document.createElement('option');
    opt1.value = v;
    opt1.textContent = v + labelSuffix;
    perSel.appendChild(opt1);

    let opt2 = opt1.cloneNode(true);
    perSel2.appendChild(opt2);
  });
  updateMaturityDate();
  updateMaturityDateMat();
}

// Update maturity date for Required Deposit (Prarthana: years, Reality: months)
function updateMaturityDate() {
  const openDate = new Date($('open').value);
  const per = parseInt($('per').value, 10);
  if (!openDate.getTime() || !per) {
    $('mdate').value = '';
    return;
  }
  let mdate = new Date(openDate);
  if (prod === 'prarthana') {
    mdate.setFullYear(mdate.getFullYear() + per);
  } else {
    mdate.setMonth(mdate.getMonth() + per);
  }
  $('mdate').value = mdate.toISOString().slice(0,10);
}

// Update maturity date for Maturity Value tab
function updateMaturityDateMat() {
  const openDate = new Date($('open2').value);
  const per = parseInt($('per2').value, 10);
  if (!openDate.getTime() || !per) {
    $('mdate2').value = '';
    return;
  }
  let mdate = new Date(openDate);
  if (prod === 'prarthana') {
    mdate.setFullYear(mdate.getFullYear() + per);
  } else {
    mdate.setMonth(mdate.getMonth() + per);
  }
  $('mdate2').value = mdate.toISOString().slice(0,10);
}

// Show tab content
function showTab(tab) {
  ['req', 'mat'].forEach(t => {
    $(t).classList.toggle('active', t === tab);
    $('tab' + (t==='req' ? 'Req' : 'Mat') + 'Btn').classList.toggle('active', t === tab);
  });
  // Reset results on tab change
  resetResults();
}

// Reset all inputs and results
function resetAll() {
  ['formReq','formMat'].forEach(id => {
    $(id).reset();
  });
  $('mdate').value = '';
  $('mdate2').value = '';
  resetResults();
}

// Reset result display
function resetResults() {
  $('res1').textContent = '';
  $('res2').textContent = '';
}

// Calculate Required Deposit (Tab 1)
function calcReq() {
  const openDate = new Date($('open').value);
  const per = parseInt($('per').value, 10);
  const target = parseFloat($('target').value);
  const rate = parseFloat($('rate').value) / 100; // convert % to decimal

  if (!openDate.getTime() || isNaN(per) || isNaN(target) || isNaN(rate)) {
    alert('Please fill all fields correctly.');
    return;
  }

  let principal;
  if (prod === 'prarthana') {
    // Yearly compounding (Prarthana)
    // Formula: P = A / (1 + r)^n
    principal = target / Math.pow(1 + rate, per);
  } else {
    // Monthly compounding (Reality) - period in months, rate monthly
    // Formula: P = A / (1 + r)^n
    principal = target / Math.pow(1 + rate, per);
  }

  principal = Math.max(principal, 0);

  let maturityDate = $('mdate').value || 'N/A';

  const result = 
    `Opening Date: ${$('open').value}\n` +
    `Maturity Date: ${maturityDate}\n` +
    `Period: ${per} ${prod === 'prarthana' ? 'years' : 'months'}\n` +
    `Target Amount: LKR ${target.toFixed(2)}\n` +
    `Interest Rate: ${ (rate * 100).toFixed(2) }% ${prod === 'prarthana' ? 'per year' : 'per month'}\n` +
    `Required Deposit: LKR ${principal.toFixed(2)}`;

  $('res1').textContent = result;
  speakResult(result);
}

// Calculate Maturity Value (Tab 2)
function calcMat() {
  const openDate = new Date($('open2').value);
  const per = parseInt($('per2').value, 10);
  const monthlyInstallment = parseFloat($('amt').value);
  const rate = parseFloat($('rate2').value) / 100; // monthly rate decimal

  if (!openDate.getTime() || isNaN(per) || isNaN(monthlyInstallment) || isNaN(rate)) {
    alert('Please fill all fields correctly.');
    return;
  }

  // Compound Interest on Annuity (Monthly installment compound interest):
  // A = P * [((1 + r)^n - 1) / r]
  let maturityValue;
  if (rate === 0) {
    maturityValue = monthlyInstallment * per;
  } else {
    maturityValue = monthlyInstallment * (Math.pow(1 + rate, per) - 1) / rate;
  }

  maturityValue = Math.max(maturityValue, 0);

  let maturityDate = $('mdate2').value || 'N/A';

  const result = 
    `Opening Date: ${$('open2').value}\n` +
    `Maturity Date: ${maturityDate}\n` +
    `Period: ${per} ${prod === 'prarthana' ? 'years' : 'months'}\n` +
    `Monthly Installment: LKR ${monthlyInstallment.toFixed(2)}\n` +
    `Interest Rate: ${(rate * 100).toFixed(2)}% per month\n` +
    `Maturity Value: LKR ${maturityValue.toFixed(2)}`;

  $('res2').textContent = result;
  speakResult(result);
}

// Print result by element id
function printRes(id) {
  const content = $(id).textContent;
  if (!content) {
    alert('Nothing to print!');
    return;
  }
  const printWindow = window.open('', '', 'width=600,height=400');
  printWindow.document.write('<pre>' + content + '</pre>');
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
}

// Email result by opening mail client (mailto)
function mailRes(id) {
  const content = $(id).textContent;
  if (!content) {
    alert('Nothing to email!');
    return;
  }
  const subject = encodeURIComponent('NSB Savings Calculator Result');
  const body = encodeURIComponent(content);
  window.location.href = `mailto:?subject=${subject}&body=${body}`;
}

// Show tab content handler called by tabs
function showTab(tab) {
  ['req','mat'].forEach(t=>{
    $(t).classList.toggle('active', t===tab);
    $('tab'+(t==='req'?'Req':'Mat')+'Btn').classList.toggle('active', t===tab);
  });
  resetResults();
}

// Reset all inputs and results
function resetAll() {
  ['formReq','formMat'].forEach(id => $(id).reset());
  $('mdate').value = '';
  $('mdate2').value = '';
  resetResults();
}

// Reset result display
function resetResults() {
  $('res1').textContent = '';
  $('res2').textContent = '';
}

// Update language-dependent labels and reload periods
function applyLang() {
  const d = TXT[curLang()];
  // Title changes by product
  $('title').textContent = prod === 'prarthana' ? d.titlePr : d.titleRe;
  document.title = $('title').textContent;
  $('title').textContent = $('title').textContent;
  $('txtReq').textContent = d.req;
  $('txtMat').textContent = d.mat;

  // Labels for Required Deposit tab
  $('lblOpen').textContent = d.open;
  $('lblPer').textContent = d.per;
  $('lblMdate').textContent = d.matDate;
  $('lblTarget').textContent = d.target;
  $('lblRate').textContent = prod === 'prarthana' ? d.rateYr : d.rateMo;

  // Labels for Maturity Value tab
  $('lblOpen2').textContent = d.open;
  $('lblPer2').textContent = d.per;
  $('lblMdate2').textContent = d.matDate;
  $('lblAmt').textContent = d.install;
  $('lblRate2').textContent = d.rateMo;

  // Buttons
  $('bCalc1').textContent = d.calc;
  $('bClr1').textContent = d.clear;
  $('bPrt1').textContent = d.print;
  $('bMail1').textContent = d.email;

  $('bCalc2').textContent = d.calc;
  $('bClr2').textContent = d.clear;
  $('bPrt2').textContent = d.print;
  $('bMail2').textContent = d.email;

  populatePeriods();
  updateMaturityDate();
  updateMaturityDateMat();
  resetResults();
}

// Text-to-speech for results (reads result aloud in selected language)
function speakResult(text) {
  if (!('speechSynthesis' in window)) return;
  const utter = new SpeechSynthesisUtterance(text);
  const lang = curLang();
  if (lang === 'si') utter.lang = 'si-LK';
  else if (lang === 'ta') utter.lang = 'ta-IN';
  else utter.lang = 'en-US';
  window.speechSynthesis.speak(utter);
}

// Initialize
function init() {
  setProduct(prod);
  applyLang();
  showTab('req');
}

init();
</script>

</body>
</html>

