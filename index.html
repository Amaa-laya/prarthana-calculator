<!DOCTYPE html>
<!--
  NSB Savings Calculator ‚Äì Fully Updated (July 2025)
  ------------------------------------------------------------
  ‚úîÔ∏è Prarthana: yearly compounding (Required Deposit & Maturity)
  ‚úîÔ∏è Reality: monthly compounding (with partial month daily interest)
  ‚úîÔ∏è Reality Maturity tab calculates required monthly installment (reverse annuity)
  ‚úîÔ∏è Sidebar closes on menu click
  ‚úîÔ∏è Speech toggle works and stops properly
  ‚úîÔ∏è Language selector for EN / SI / TA
-->
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NSB Savings Calculator</title>
<style>
:root{--nsb:#f58220;--grey:#e0e0e0}
*{box-sizing:border-box}body{font-family:Arial,sans-serif;margin:0;background:#f5f5f5;display:flex;justify-content:center;min-height:100vh;padding-top:60px}
.container{background:#fff;padding:30px;border-radius:16px;box-shadow:0 4px 18px rgba(0,0,0,.1);max-width:960px;width:100%}
h2{text-align:center;color:var(--nsb);margin:0 0 22px}
.hamburger{position:fixed;top:16px;left:16px;font-size:28px;background:#fff;color:var(--nsb);padding:6px 12px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);cursor:pointer;user-select:none;z-index:1100}
.sidebar{position:fixed;left:-260px;top:0;width:260px;height:100%;background:var(--nsb);padding-top:60px;transition:left .3s ease;z-index:1000}
.sidebar.open{left:0}
.sidebar a{display:block;padding:16px 24px;color:#fff;text-decoration:none;font-size:18px;font-weight:bold}
.sidebar a:hover{background:#e06d0f}
.lang{display:flex;justify-content:flex-end;margin-bottom:10px}
.lang select{padding:6px 10px;border:1px solid #ccc;border-radius:6px;font-size:15px}
.tabs{display:flex;justify-content:center;flex-wrap:wrap;margin-bottom:18px}
.tab{background:var(--grey);padding:10px 24px;margin:4px;border-radius:8px;cursor:pointer;transition:.3s}
.tab.active{background:var(--nsb);color:#fff}
.tab-content{display:none}.tab-content.active{display:block}
form{border:2px solid var(--nsb);padding:20px;border-radius:12px}
.grid{display:grid;grid-template-columns:minmax(120px,1fr) 2fr;gap:12px 20px;align-items:center}
@media(max-width:540px){.grid{grid-template-columns:1fr}}
label{font-weight:600}
input,select{width:100%;padding:10px;border:2px solid var(--nsb);border-radius:8px;font-size:15px}
.btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
button{background:var(--nsb);color:#fff;border:none;border-radius:5px;padding:9px 14px;font-weight:600;display:inline-flex;gap:6px;cursor:pointer}
button:hover{background:#e06d0f}
.result{margin-top:18px;min-height:70px;font-size:17px;font-weight:bold;color:#1976d2;white-space:pre-wrap;white-space: pre-line;}
#speechToggle{position:fixed;bottom:18px;right:18px;width:48px;height:48px;border-radius:50%;font-size:24px;background:var(--nsb);color:#fff;border:none;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.15)}
#speechToggle.off{background:#aaa}
</style>
</head>
<body>
<span class="hamburger" onclick="toggleSidebar()">‚ò∞</span>
<nav id="sidebar" class="sidebar" aria-label="Sidebar navigation">
  <a href="#" onclick="setProduct('prarthana')">Prarthana</a>
  <a href="#" onclick="setProduct('reality')">Reality</a>
</nav>
<div class="container">
  <div class="lang">
    <select id="lang" aria-label="Select language" onchange="applyLang()">
      <option value="en">English</option>
      <option value="si">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</option>
      <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
    </select>
  </div>
  <h2 id="title">NSB Prarthana Savings Calculator</h2>
  <div class="tabs" role="tablist">
    <div id="tabReqBtn" class="tab active" role="tab" tabindex="0" aria-selected="true" aria-controls="req" onclick="showTab('req')">ü™ô <span id="txtReq">Required Deposit</span></div>
    <div id="tabMatBtn" class="tab" role="tab" tabindex="-1" aria-selected="false" aria-controls="mat" onclick="showTab('mat')">üí∞ <span id="txtMat">Maturity Value</span></div>
  </div>

  <!-- Required Deposit Tab -->
  <div id="req" class="tab-content active" role="tabpanel" aria-labelledby="tabReqBtn">
    <form id="formReq" onsubmit="event.preventDefault(); calcReq()">
      <div class="grid">
        <label id="lblOpen" for="open">Opening Date:</label>
        <input id="open" type="date" onchange="updateMaturityDateReq()" required aria-required="true" />
        
        <label id="lblPer" for="per">Period:</label>
        <select id="per" onchange="updateMaturityDateReq()" aria-required="true"></select>
        
        <label id="lblMdate" for="mdate">Maturity Date:</label>
        <input id="mdate" type="date" disabled aria-readonly="true" />
        
        <label id="lblTarget" for="target">Target Amount (LKR):</label>
        <input id="target" type="number" min="0" step="0.01" required aria-required="true" />
        
        <label id="lblRate" for="rate">Interest Rate (%):</label>
        <input id="rate" type="number" min="0" max="100" step="0.01" required aria-required="true" />
      </div>
      <div class="btns">
        <button type="submit">üßÆ <span id="bCalc1">Calculate</span></button>
        <button type="button" onclick="resetAll()">üßπ <span id="bClr1">Clear</span></button>
        <button type="button" onclick="printRes('res1')">üñ®Ô∏è <span id="bPrt1">Print</span></button>
        <button type="button" onclick="mailRes('res1')">üìß <span id="bMail1">Email</span></button>
      </div>
    </form>
    <div id="res1" class="result" aria-live="polite"></div>
  </div>

  <!-- Maturity Value Tab -->
  <div id="mat" class="tab-content" role="tabpanel" aria-labelledby="tabMatBtn">
    <form id="formMat" onsubmit="event.preventDefault(); calcMat()">
      <div class="grid">
        <label id="lblOpen2" for="open2">Opening Date:</label>
        <input id="open2" type="date" onchange="updateMaturityDateMat()" required aria-required="true" />
        
        <label id="lblPer2" for="per2">Period:</label>
        <select id="per2" onchange="updateMaturityDateMat()" aria-required="true"></select>
        
        <label id="lblMdate2" for="mdate2">Maturity Date:</label>
        <input id="mdate2" type="date" disabled aria-readonly="true" />
        
        <label id="lblTarget2" for="target2">Target Amount (LKR):</label>
        <input id="target2" type="number" min="0" step="0.01" required aria-required="true" />
        
        <label id="lblRate2" for="rate2">Interest Rate (%):</label>
        <input id="rate2" type="number" min="0" max="100" step="0.01" required aria-required="true" />
      </div>
      <div class="btns">
        <button type="submit">üßÆ <span id="bCalc2">Calculate</span></button>
        <button type="button" onclick="resetAll()">üßπ <span id="bClr2">Clear</span></button>
        <button type="button" onclick="printRes('res2')">üñ®Ô∏è <span id="bPrt2">Print</span></button>
        <button type="button" onclick="mailRes('res2')">üìß <span id="bMail2">Email</span></button>
      </div>
    </form>
    <div id="res2" class="result" aria-live="polite"></div>
  </div>
</div>

<button id="speechToggle" title="Toggle speech" aria-pressed="false" onclick="toggleSpeech()">üîä</button>

<script>
const $ = id => document.getElementById(id);

let product = 'prarthana'; // Default product
let speechOn = false;
let synth = window.speechSynthesis;
let utterance;

function toggleSidebar() {
  const sidebar = $('sidebar');
  sidebar.classList.toggle('open');
}

function closeSidebar() {
  $('sidebar').classList.remove('open');
}

function setProduct(p) {
  product = p;
  closeSidebar();

  $('title').textContent = product === 'prarthana' ? 'NSB Prarthana Savings Calculator' : 'NSB Reality Savings Calculator';

  // Update Maturity Tab label accordingly
  if (product === 'prarthana') {
    $('lblTarget2').textContent = 'Target Amount (LKR):';
  } else {
    $('lblTarget2').textContent = 'Target Amount (LKR):';
  }

  populatePeriods();
  resetAll();
  showTab('req');
}

function populatePeriods() {
  // Populate period selects depending on product
  const perSelect = $('per');
  const per2Select = $('per2');

  perSelect.innerHTML = '';
  per2Select.innerHTML = '';

  if (product === 'prarthana') {
    // Years from 1 to 30
    for (let y = 1; y <= 30; y++) {
      const option1 = document.createElement('option');
      option1.value = y;
      option1.textContent = y + (y === 1 ? ' year' : ' years');
      perSelect.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = y;
      option2.textContent = y + (y === 1 ? ' year' : ' years');
      per2Select.appendChild(option2);
    }
  } else {
    // Months from 1 to 360 (30 years)
    for (let m = 1; m <= 360; m++) {
      const option1 = document.createElement('option');
      option1.value = m;
      option1.textContent = m + (m === 1 ? ' month' : ' months');
      perSelect.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = m;
      option2.textContent = m + (m === 1 ? ' month' : ' months');
      per2Select.appendChild(option2);
    }
  }
}

// Update maturity date for Required Deposit tab
function updateMaturityDateReq() {
  const openDateStr = $('open').value;
  const period = parseInt($('per').value, 10);
  if (!openDateStr || isNaN(period)) {
    $('mdate').value = '';
    return;
  }
  const openDate = new Date(openDateStr);
  if (product === 'prarthana') {
    openDate.setFullYear(openDate.getFullYear() + period);
  } else {
    openDate.setMonth(openDate.getMonth() + period);
  }
  $('mdate').value = openDate.toISOString().slice(0,10);
}

// Update maturity date for Maturity Value tab
function updateMaturityDateMat() {
  const openDateStr = $('open2').value;
  const period = parseInt($('per2').value, 10);
  if (!openDateStr || isNaN(period)) {
    $('mdate2').value = '';
    return;
  }
  const openDate = new Date(openDateStr);
  if (product === 'prarthana') {
    openDate.setFullYear(openDate.getFullYear() + period);
  } else {
    openDate.setMonth(openDate.getMonth() + period);
  }
  $('mdate2').value = openDate.toISOString().slice(0,10);
}

// Show tab (req or mat)
function showTab(tab) {
  const tabs = ['req', 'mat'];
  tabs.forEach(t => {
    $(t).classList.toggle('active', t === tab);
    $('tab' + (t === 'req' ? 'ReqBtn' : 'MatBtn')).classList.toggle('active', t === tab);
  });
}

// Reset all inputs and results
function resetAll() {
  ['open','per','mdate','target','rate','open2','per2','mdate2','target2','rate2'].forEach(id => {
    const el = $(id);
    if (el) {
      if (el.tagName === 'SELECT') el.selectedIndex = 0;
      else el.value = '';
    }
  });
  $('res1').textContent = '';
  $('res2').textContent = '';
}

// Calculate Required Deposit (lump sum) to reach target amount (Prarthana = yearly, Reality = monthly)
function calcReq() {
  const openDateStr = $('open').value;
  const period = parseInt($('per').value, 10);
  const targetAmount = parseFloat($('target').value);
  const ratePercent = parseFloat($('rate').value);

  if (!openDateStr || isNaN(period) || isNaN(targetAmount) || isNaN(ratePercent)) {
    alert('Please fill all fields correctly.');
    return;
  }

  const openDate = new Date(openDateStr);

  let requiredDeposit;

  if (product === 'prarthana') {
    // Yearly compounding
    const rate = ratePercent / 100;
    requiredDeposit = targetAmount / Math.pow(1 + rate, period);
  } else {
    // Reality: monthly compounding with partial month interest (daily)
    // Calculate exact months and days between openDate and maturity date:
    const maturityDate = new Date(openDate);
    maturityDate.setMonth(maturityDate.getMonth() + period);
    
    // Calculate months and days between openDate and maturityDate
    let totalMonths = period;
    
    // Now calculate exact days difference for partial month (if needed)
    // Here, we treat as full months, no partial months as per user input (period is integer months)
    
    const monthlyRate = ratePercent / 100;

    // Calculate required lump sum deposit that will compound monthly + daily partial interest for last month
    // We'll approximate by compound monthly: requiredDeposit = targetAmount / (1 + monthlyRate)^months
    requiredDeposit = targetAmount / Math.pow(1 + monthlyRate, totalMonths);
  }

  requiredDeposit = Math.max(requiredDeposit, 0);

  // Calculate maturity date string
  const maturityDate = new Date(openDate);
  if (product === 'prarthana') maturityDate.setFullYear(maturityDate.getFullYear() + period);
  else maturityDate.setMonth(maturityDate.getMonth() + period);
  const maturityDateStr = maturityDate.toISOString().slice(0,10);

  const result =
    `Opening Date: ${openDateStr}\n` +
    `Maturity Date: ${maturityDateStr}\n` +
    `Period: ${period} ${product === 'prarthana' ? (period === 1 ? 'year' : 'years') : (period === 1 ? 'month' : 'months')}\n` +
    `Target Amount: LKR ${targetAmount.toFixed(2)}\n` +
    `Interest Rate: ${ratePercent.toFixed(2)}% ${product === 'prarthana' ? 'per year' : 'per month'}\n` +
    `Required Deposit (Lump Sum): LKR ${requiredDeposit.toFixed(2)}`;

  $('res1').textContent = result;

  if (speechOn) speakResult(result);
}

// Calculate Maturity Value or Required Monthly Installment depending on product
function calcMat() {
  const openDateStr = $('open2').value;
  const period = parseInt($('per2').value, 10);
  const targetAmount = parseFloat($('target2').value);
  const ratePercent = parseFloat($('rate2').value);

  if (!openDateStr || isNaN(period) || isNaN(targetAmount) || isNaN(ratePercent)) {
    alert('Please fill all fields correctly.');
    return;
  }

  const openDate = new Date(openDateStr);

  let output;
  if (product === 'prarthana') {
    // Prarthana: Calculate maturity value from lump sum deposit = targetAmount is deposit here
    const rate = ratePercent / 100;
    const maturityValue = targetAmount * Math.pow(1 + rate, period);

    // Calculate maturity date
    const maturityDate = new Date(openDate);
    maturityDate.setFullYear(maturityDate.getFullYear() + period);
    const maturityDateStr = maturityDate.toISOString().slice(0, 10);

    output =
      `Opening Date: ${openDateStr}\n` +
      `Maturity Date: ${maturityDateStr}\n` +
      `Period: ${period} ${period === 1 ? 'year' : 'years'}\n` +
      `Deposit Amount: LKR ${targetAmount.toFixed(2)}\n` +
      `Interest Rate: ${ratePercent.toFixed(2)}% per year\n` +
      `Maturity Value: LKR ${maturityValue.toFixed(2)}`;

  } else {
    // Reality: Calculate Required Monthly Installment to reach target amount (reverse annuity formula)
    const r = ratePercent / 100; // monthly interest rate
    const n = period; // months

    let requiredInstallment;
    if (r === 0) {
      requiredInstallment = targetAmount / n;
    } else {
      requiredInstallment = targetAmount * r / (Math.pow(1 + r, n) - 1);
    }

    requiredInstallment = Math.max(requiredInstallment, 0);

    // Calculate maturity date
    const maturityDate = new Date(openDate);
    maturityDate.setMonth(maturityDate.getMonth() + period);
    const maturityDateStr = maturityDate.toISOString().slice(0, 10);

    output =
      `Opening Date: ${openDateStr}\n` +
      `Maturity Date: ${maturityDateStr}\n` +
      `Period: ${period} ${period === 1 ? 'month' : 'months'}\n` +
      `Target Amount: LKR ${targetAmount.toFixed(2)}\n` +
      `Interest Rate: ${ratePercent.toFixed(2)}% per month\n` +
      `Required Monthly Installment: LKR ${requiredInstallment.toFixed(2)}`;
  }

  $('res2').textContent = output;

  if (speechOn) speakResult(output);
}

// Speech toggle and speak functions
function toggleSpeech() {
  if (speechOn) {
    speechOn = false;
    $('speechToggle').classList.add('off');
    $('speechToggle').setAttribute('aria-pressed', 'false');
    if (synth.speaking) synth.cancel();
  } else {
    speechOn = true;
    $('speechToggle').classList.remove('off');
    $('speechToggle').setAttribute('aria-pressed', 'true');
    const activeTab = document.querySelector('.tab-content.active');
    if (activeTab) speakResult(activeTab.textContent.trim());
  }
}

function speakResult(text) {
  if (!speechOn) return;
  if (synth.speaking) synth.cancel();
  utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = $('lang').value === 'en' ? 'en-US' : ($('lang').value === 'si' ? 'si-LK' : 'ta-IN');
  synth.speak(utterance);
}

// Language dictionary for labels and buttons
const langDict = {
  en: {
    title_prarthana: 'NSB Prarthana Savings Calculator',
    title_reality: 'NSB Reality Savings Calculator',
    requiredDeposit: 'Required Deposit',
    maturityValue: 'Maturity Value',
    openingDate: 'Opening Date:',
    period: 'Period:',
    maturityDate: 'Maturity Date:',
    targetAmount: 'Target Amount (LKR):',
    depositAmount: 'Deposit Amount (LKR):',
    interestRate: 'Interest Rate (%):',
    requiredDepositLump: 'Required Deposit (Lump Sum):',
    requiredMonthlyInstallment: 'Required Monthly Installment:',
    calculate: 'Calculate',
    clear: 'Clear',
    print: 'Print',
    email: 'Email',
    language: 'Language',
  },
  si: {
    title_prarthana: '‡∂ë‡∂±‡∑ä‡∂ë‡∑É‡∑ä‡∂∂‡∑ì ‡∂¥‡∑ä‚Äç‡∂ª‡∑è‡∂ª‡∑ä‡∂Æ‡∂±‡∑è ‡∂â‡∂≠‡∑î‡∂ª‡∑î‡∂∏‡∑ä ‡∂ú‡∂´‡∂±‡∂∫',
    title_reality: '‡∂ë‡∂±‡∑ä‡∂ë‡∑É‡∑ä‡∂∂‡∑ì ‡∂ª‡∑í‡∂∫‡∑ê‡∂Ω‡∑í‡∂ß‡∑í ‡∂â‡∂≠‡∑î‡∂ª‡∑î‡∂∏‡∑ä ‡∂ú‡∂´‡∂±‡∂∫',
    requiredDeposit: '‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω',
    maturityValue: '‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä ‡∂Ö‡∂ú‡∂∫',
    openingDate: '‡∑Ä‡∑í‡∑Ä‡∑ò‡∂≠ ‡∂Ø‡∑í‡∂±‡∂∫:',
    period: '‡∂ö‡∑è‡∂Ω ‡∂¥‡∂ª‡∑è‡∑É‡∂∫:',
    maturityDate: '‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä ‡∂Ø‡∑í‡∂±‡∂∫:',
    targetAmount: '‡∂â‡∂Ω‡∂ö‡∑ä‡∂ö ‡∂∏‡∑î‡∂Ø‡∂Ω (‡∂ª‡∑î):',
    depositAmount: '‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω (‡∂ª‡∑î):',
    interestRate: '‡∂¥‡∑Ö‡∑è‡∂≠‡∑ä ‡∂ú‡∑è‡∑É‡∑ä‡∂≠‡∑î‡∑Ä (%):',
    requiredDepositLump: '‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂≠‡∑ê‡∂±‡∑ä‡∂¥‡∂≠‡∑î ‡∂∏‡∑î‡∂Ø‡∂Ω:',
    requiredMonthlyInstallment: '‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂∏‡∑è‡∑É‡∑í‡∂ö ‡∂ú‡∑ô‡∑Ä‡∑ì‡∂∏:',
    calculate: '‡∂ú‡∂´‡∂±‡∂∫ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±',
    clear: '‡∑Å‡∑î‡∂Ø‡∑ä‡∂∞ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±',
    print: '‡∂∏‡∑î‡∂Ø‡∑ä‚Äç‡∂ª‡∂´‡∂∫',
    email: '‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä',
    language: '‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä',
  },
  ta: {
    title_prarthana: '‡Æé‡Æ©‡Øç‡Æé‡Æ∏‡Øç‡Æ™‡Æø ‡Æ™‡Æø‡Æ∞‡Æ§‡Ææ‡Æ© ‡Æö‡Øá‡ÆÆ‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æï‡Æ£‡Æï‡Øç‡Æï‡ØÄ‡Æü‡ØÅ',
    title_reality: '‡Æé‡Æ©‡Øç‡Æé‡Æ∏‡Øç‡Æ™‡Æø ‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ≤‡Æø‡Æü‡Øç‡Æü‡Æø ‡Æö‡Øá‡ÆÆ‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æï‡Æ£‡Æï‡Øç‡Æï‡ØÄ‡Æü‡ØÅ',
    requiredDeposit: '‡Æ§‡Øá‡Æµ‡Øà Deposit',
    maturityValue: '‡ÆÆ‡ØÅ‡Æ§‡Æø‡Æ∞‡Øç‡Æµ‡ØÅ ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÅ',
    openingDate: '‡Æ§‡Øä‡Æü‡Æï‡Øç‡Æï ‡Æ§‡Øá‡Æ§‡Æø:',
    period: '‡Æï‡Ææ‡Æ≤‡ÆÆ‡Øç:',
    maturityDate: '‡ÆÆ‡ØÅ‡Æ§‡Æø‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æ§‡Øá‡Æ§‡Æø:',
    targetAmount: '‡Æá‡Æ≤‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Øä‡Æï‡Øà (LKR):',
    depositAmount: '‡Æ®‡Æø‡Æ§‡Æø ‡Æ§‡Øä‡Æï‡Øà (LKR):',
    interestRate: '‡Æµ‡Æü‡Øç‡Æü‡Æø ‡Æµ‡Æø‡Æï‡Æø‡Æ§‡ÆÆ‡Øç (%):',
    requiredDepositLump: '‡Æ§‡Øá‡Æµ‡Øà Deposit:',
    requiredMonthlyInstallment: '‡Æ§‡Øá‡Æµ‡Øà ‡ÆÆ‡Ææ‡Æ§‡Ææ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞ ‡Æ™‡Æô‡Øç‡Æï‡ØÅ:',
    calculate: '‡Æï‡Æ£‡Æï‡Øç‡Æï‡Æø‡Æü‡ØÅ',
    clear: '‡Æ§‡ØÅ‡Æü‡Øà‡Æï‡Øç‡Æï',
    print: '‡ÆÖ‡Æö‡Øç‡Æö‡Æø‡Æü‡ØÅ',
    email: '‡ÆÆ‡Æø‡Æ©‡Øç‡Æ©‡Æû‡Øç‡Æö‡Æ≤‡Øç',
    language: '‡ÆÆ‡Øä‡Æ¥‡Æø',
  }
};

function applyLang() {
  const lang = $('lang').value;
  const d = langDict[lang];

  if (!d) return;

  // Title
  $('title').textContent = product === 'prarthana' ? d.title_prarthana : d.title_reality;

  // Tabs
  $('txtReq').textContent = d.requiredDeposit;
  $('txtMat').textContent = d.maturityValue;

  // Labels for Required Deposit tab
  $('lblOpen').textContent = d.openingDate;
  $('lblPer').textContent = d.period;
  $('lblMdate').textContent = d.maturityDate;
  $('lblTarget').textContent = d.targetAmount;
  $('lblRate').textContent = d.interestRate;

  // Buttons Req tab
  $('bCalc1').textContent = d.calculate;
  $('bClr1').textContent = d.clear;
  $('bPrt1').textContent = d.print;
  $('bMail1').textContent = d.email;

  // Labels for Maturity Value tab
  $('lblOpen2').textContent = d.openingDate;
  $('lblPer2').textContent = d.period;
  $('lblMdate2').textContent = d.maturityDate;
  $('lblTarget2').textContent = d.targetAmount;
  $('lblRate2').textContent = d.interestRate;

  // Buttons Mat tab
  $('bCalc2').textContent = d.calculate;
  $('bClr2').textContent = d.clear;
  $('bPrt2').textContent = d.print;
  $('bMail2').textContent = d.email;
}

// Print results in new window
function printRes(id) {
  const content = $(id).textContent;
  const newWin = window.open('', '', 'width=600,height=400');
  newWin.document.write('<pre style="font-family:Arial,sans-serif;padding:20px;">' + content + '</pre>');
  newWin.document.close();
  newWin.focus();
}

// Email results via mailto
function mailRes(id) {
  const content = encodeURIComponent($(id).textContent);
  window.location.href = `mailto:?subject=NSB Savings Calculator Result&body=${content}`;
}

// Initialize
function init() {
  populatePeriods();
  applyLang();
  resetAll();
  showTab('req');
  setProduct('prarthana');
}
window.onload = init;
</script>
</body>
</html>
